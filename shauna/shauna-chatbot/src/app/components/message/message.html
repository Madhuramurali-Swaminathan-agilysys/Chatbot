<div class="message-container" [class.user-message]="message.isUser" [class.bot-message]="!message.isUser">
  <div class="message-wrapper">
    <!-- Avatar -->
    <div class="avatar" *ngIf="showAvatar" [style.background-color]="getAvatarColor()">
      <mat-icon *ngIf="!message.isUser">smart_toy</mat-icon>
      <mat-icon *ngIf="message.isUser">person</mat-icon>
    </div>

    <!-- Message Content -->
    <div class="message-content">
      <!-- Message indicators -->
      <div class="message-indicators" *ngIf="message.isVoiceInput || message.isVoiceOutput">
        <mat-icon 
          *ngIf="message.isVoiceInput" 
          matTooltip="Voice input"
          class="voice-indicator">
          mic
        </mat-icon>
        <mat-icon 
          *ngIf="message.isVoiceOutput" 
          matTooltip="Voice output"
          class="voice-indicator">
          volume_up
        </mat-icon>
      </div>

      <!-- Files -->
      <div class="message-files" *ngIf="message.files && message.files.length > 0">
        <div class="file-item" *ngFor="let file of message.files">
          <mat-icon>{{ getFileIcon(file) }}</mat-icon>
          <div class="file-info">
            <span class="file-name">{{ file.name }}</span>
            <span class="file-size">{{ formatFileSize(file.size) }}</span>
          </div>
        </div>
      </div>

      <!-- Message text -->
      <div class="message-text" *ngIf="message.content && !message.isLoading">
        <div [innerHTML]="formattedContent"></div>
      </div>

      <!-- Loading indicator -->
      <div class="message-loading" *ngIf="message.isLoading">
        <div class="typing-indicator">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <span class="loading-text">Shauna is typing...</span>
      </div>

      <!-- Timestamp -->
      <div class="message-timestamp" *ngIf="showTimestamp">
        {{ message.timestamp | date:'short' }}
      </div>
    </div>
  </div>
</div>
